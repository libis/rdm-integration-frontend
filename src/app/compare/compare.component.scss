// Author: Kris Dekeyser @ KU Leuven (2023). Apache 2.0 License

.icon_col {
  width: 5rem;
}

.page-title {
  margin: 0 0 0.5rem 0;
}

.bulk-actions button + button {
  margin-left: 0.4rem; /* small sliver of whitespace between buttons */
}

/* Ensure filter and action icons show hover */
th .pi:hover {
  opacity: 0.9;
}

.bulk-label {
  font-size: 1.2rem;
  position: relative;
  top: -0.1rem;
  margin-right: 0.6rem;
}

/* --- Dark mode readability enhancements --- */
:host ::ng-deep .p-treetable {
  background: transparent;
  color: var(--p-text-color);
}

/* Palette variables (scoped so they don't leak globally). */
:host {
  /* Base chroma tokens */
  --action-green: #1b5e36;
  --action-blue: #0f4470;
  --action-red: #6f1d28;
  --action-neutral: #2d3a46;

  /* Light mode soft tints */
  --lm-tint-green: #e6f6ed;
  --lm-tint-blue: #e5f2fb;
  --lm-tint-red: #fae6e9;
  --lm-tint-neutral: #eef2f5;

  /* Dark mode solid backgrounds */
  --dm-bg-green: #284d33;
  --dm-bg-blue: #18324d;
  --dm-bg-red: #4d1e23;
  --dm-bg-neutral: #2d3a46;

  /* Foregrounds */
  --fg-green-dark: #d9f2e1;
  --fg-blue-dark: #d3ebff;
  --fg-red-dark: #f8d7da;
  --fg-neutral-dark: #dde6ed;
  --fg-green-light: #114226;
  --fg-blue-light: #0d3352;
  --fg-red-light: #51131b;
  --fg-neutral-light: #1d2730;

  /* Defaults assume dark mode; overridden below for light */
  --file-copy-bg: var(--dm-bg-green);
  --file-copy-fg: var(--fg-green-dark);
  --file-update-bg: var(--dm-bg-blue);
  --file-update-fg: var(--fg-blue-dark);
  --file-delete-bg: var(--dm-bg-red);
  --file-delete-fg: var(--fg-red-dark);
  --file-custom-bg: var(--dm-bg-neutral);
  --file-custom-fg: var(--fg-neutral-dark);
  --row-hover-outline: rgba(255,255,255,0.08);
  --row-border-color: rgba(255,255,255,0.07);
}

/* Light theme overrides (attribute or absence of explicit dark) */
:root[data-theme='light'] app-compare,
:root:not([data-theme='dark']) app-compare {
  --file-copy-bg: var(--lm-tint-green);
  --file-copy-fg: var(--fg-green-light);
  --file-update-bg: var(--lm-tint-blue);
  --file-update-fg: var(--fg-blue-light);
  --file-delete-bg: var(--lm-tint-red);
  --file-delete-fg: var(--fg-red-light);
  --file-custom-bg: var(--lm-tint-neutral);
  --file-custom-fg: var(--fg-neutral-light);
  --row-hover-outline: rgba(0,0,0,0.08);
  --row-border-color: rgba(0,0,0,0.07);
}

/* Ensure destination (right) column text is readable */
:host ::ng-deep .p-treetable-tbody > tr > td:last-child {
  color: var(--p-text-color);
}

/* Links in destination column */
:host ::ng-deep .p-treetable-tbody > tr > td:last-child a {
  color: var(--p-primary-color, #3788d8);
  text-decoration: none;
}
:host ::ng-deep .p-treetable-tbody > tr > td:last-child a:hover {
  text-decoration: underline;
}

/* Status / action icons better contrast on dark backgrounds */
:host ::ng-deep .p-treetable .pi {
  color: var(--p-text-color-secondary, var(--p-text-color));
  opacity: 0.85;
}

/* Explicit success / danger coloring where checkmarks or delete icons appear */
:host ::ng-deep .p-treetable .pi-check {
  color: var(--p-green-400, #22c55e) !important;
  filter: drop-shadow(0 0 2px rgba(0,0,0,.4));
}
:host ::ng-deep .p-treetable .pi-times,
:host ::ng-deep .p-treetable .pi-trash {
  color: var(--p-danger-color, #ff4d4f) !important;
}

/* Slight highlight for rows on hover for orientation */
:host ::ng-deep .p-treetable-tbody > tr:hover > td {
  background: rgba(255,255,255,0.05);
  box-shadow: inset 0 0 0 1px var(--row-hover-outline);
}

/* Compact the padding slightly so background highlight shows as a bar */
:host ::ng-deep .p-treetable-tbody > tr > td {
  padding-top: 0.4rem;
  padding-bottom: 0.35rem;
  border-bottom: 1px solid var(--row-border-color);
}

/* Improve readability of file rows: ensure text inherits proper contrast inside colored backgrounds */
:host ::ng-deep .p-treetable-tbody > tr > td span, 
:host ::ng-deep .p-treetable-tbody > tr > td a, 
:host ::ng-deep .p-treetable-tbody > tr > td {
  font-weight: 500;
}

/* Provide subtle focus ring when navigating via keyboard */
:host ::ng-deep .p-treetable-tbody > tr:focus-visible > td {
  outline: 2px solid var(--p-primary-color, #3b82f6);
  outline-offset: -2px;
}

/* Reduce color intensity for nested folders (less visual noise) */
:host ::ng-deep .p-treetable-tbody > tr > td:first-child .pi.pi-folder {
  opacity: 0.7;
}

/* Distinguish deleted rows text slightly */
:host ::ng-deep tr[style*='file-delete-bg'] td {
  text-decoration: none; /* keep clean */
}

/* Ensure long filenames wrap gracefully */
:host ::ng-deep .p-treetable-tbody > tr > td {
  word-break: break-word;
}

/* Centered action buttons with wrapping and spacing */
.compare-action-buttons button {
  margin: 0.15rem 0.4rem; /* tighter vertical space, keep horizontal */
}

@media (max-width: 576px) { /* small screens: a bit more vertical space */
  .compare-action-buttons button {
    flex: 1 1 45%; /* allow two per row */
    min-width: 7.5rem;
  }
}

@media (min-width: 577px) {
  .compare-action-buttons button {
    flex: 0 0 auto;
  }
}